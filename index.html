<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û–≤—Ä—É—Ü—å–∫–∏–π –ó–î–û ‚Ññ8 –õ–∞—Å—Ç—ñ–≤–∫–∞ –û–≤—Ä—É—Ü—å–∫–æ—ó –º—ñ—Å—å–∫–æ—ó —Ä–∞–¥–∏</title>
    <meta name="description" content="–û—Ñ—ñ—Ü—ñ–π–Ω–∏–π —Å–∞–π—Ç –ó–î–û ¬´–°–∞–¥–æ—á–æ–∫ –õ–∞—Å—Ç—ñ–≤–∫–∞¬ª. –î–∏—Ç—è—á–∏–π —Å–∞–¥–æ–∫ –¥–ª—è –≥–∞—Ä–º–æ–Ω—ñ–π–Ω–æ–≥–æ —Ä–æ–∑–≤–∏—Ç–∫—É –¥—ñ—Ç–µ–π –≤—ñ–¥ 2 –¥–æ 7 —Ä–æ–∫—ñ–≤. –Ø–∫—ñ—Å–Ω–∞ –¥–æ—à–∫—ñ–ª—å–Ω–∞ –æ—Å–≤—ñ—Ç–∞, —ñ–Ω–∫–ª—é–∑–∏–≤–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è, –¥–æ—Å–≤—ñ–¥—á–µ–Ω—ñ –ø–µ–¥–∞–≥–æ–≥–∏.">
    <meta name="keywords" content="–ó–î–û –õ–∞—Å—Ç—ñ–≤–∫–∞, –°–∞–¥–æ—á–æ–∫ –õ–∞—Å—Ç—ñ–≤–∫–∞, –ó–î–û –°–∞–¥–æ—á–æ–∫ –õ–∞—Å—Ç—ñ–≤–∫–∞, –¥–∏—Ç—è—á–∏–π —Å–∞–¥–æ–∫, –¥–æ—à–∫—ñ–ª—å–Ω–∞ –æ—Å–≤—ñ—Ç–∞, –¥–∏—Ç—è—á–∏–π —Å–∞–¥ –£–∫—Ä–∞—ó–Ω–∞, –≤–∏—Ö–æ–≤–∞–Ω–Ω—è –¥—ñ—Ç–µ–π, —ñ–Ω–∫–ª—é–∑–∏–≤–Ω–∞ –æ—Å–≤—ñ—Ç–∞">
    <meta name="author" content="–û–≤—Ä—É—Ü—å–∫–∏–π –ó–î–û ‚Ññ8 –õ–∞—Å—Ç—ñ–≤–∫–∞ –û–≤—Ä—É—Ü—å–∫–æ—ó –º—ñ—Å—å–∫–æ—ó —Ä–∞–¥–∏">
    <meta name="google-site-verification" content="L3aMoZRFZU0pbWwUjJfPDd5h7hcqdM3p3z4dfj7Qqo4" />
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XXXXXXXXXX');
    </script>
    
    <!-- Structured Data -->
    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "EducationalOrganization",
  "name": "–ó–î–û ‚Ññ8 –õ–∞—Å—Ç—ñ–≤–∫–∞ –û–≤—Ä—É—Ü—å–∫–æ—ó –º—ñ—Å—å–∫–æ—ó —Ä–∞–¥–∏",
  "description": "–î–∏—Ç—è—á–∏–π —Å–∞–¥–æ–∫ –¥–ª—è –¥–æ—à–∫—ñ–ª—å–Ω–æ—ó –æ—Å–≤—ñ—Ç–∏ –¥—ñ—Ç–µ–π –≤—ñ–∫–æ–º –≤—ñ–¥ 1 –¥–æ 6 —Ä–æ–∫—ñ–≤",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "–≤—É–ª. –ü—Ä–∏–∫–æ—Ä–¥–æ–Ω–Ω–∞",
    "addressLocality": "–û–≤—Ä—É—á",
    "addressRegion": "–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å",
    "addressCountry": "UA"
  },
  "telephone": "",
  "email": "",
  "url": "https://lastivkadev.github.io/Lastivka_zdo_/",
  "openingHours": "Mo-Fr 07:30-18:30"
}
    </script>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üë∂</text></svg>">
    
    <style>
    /* –ë–ê–ó–û–í–Ü –°–¢–ò–õ–Ü */
    :root {
        --primary: #4a6fa5;
        --primary-dark: #385d8a;
        --accent: #6dbfb8;
        --light: #ffffff;
        --light-gray: #f5f7fa;
        --dark: #343a40;
        --shadow: 0 5px 15px rgba(0,0,0,0.1);
        --radius: 12px;
        --bg-color: #ffffff;
        --text-color: #343a40;
        --card-bg: #ffffff;
    }

    /* –¢–µ–º–Ω–∞ —Ç–µ–º–∞ */
    .dark-theme {
        --bg-color: #1a1a1a;
        --text-color: #f0f0f0;
        --card-bg: #2a2a2a;
        --light-gray: #333333;
        --dark: #f0f0f0;
        --light: #2a2a2a;
    }
    
    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }
    
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: var(--bg-color);
        color: var(--text-color);
        line-height: 1.6;
        transition: background 0.3s, color 0.3s;
    }
    
    /* HEADER */
    header {
        background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        color: rgb(255, 255, 255);
        padding: 25px 20px;
        text-align: center;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        position: relative;
    }
    
    header h1 {
        font-size: 2.2rem;
        margin-bottom: 10px;
        font-weight: 700;
    }
    
    header p {
        font-size: 1.1rem;
        opacity: 0.9;
    }
    
    .header-buttons {
        margin-top: 20px;
        display: flex;
        justify-content: center;
        gap: 15px;
        align-items: center;
    }
    
    .header-btn {
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255,255,255,0.3);
        color: #ffffff;
        padding: 12px 25px;
        border-radius: 50px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        display: inline-flex;
        align-items: center;
        gap: 10px;
    }
    
    .header-btn:hover {
        background: rgba(255,255,255,0.3);
        transform: translateY(-2px);
    }
    
    /* –ü—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —Ö–µ–¥–µ—Ä—ñ */
    .user-profile-header {
        display: flex;
        align-items: center;
        gap: 15px;
        background: rgba(255, 255, 255, 0.15);
        padding: 10px 20px;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .user-profile-header:hover {
        background: rgba(255, 255, 255, 0.25);
    }
    
    .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid white;
    }
    
    .user-name {
        font-weight: 600;
        font-size: 1rem;
    }
    
    /* NAVIGATION */
    nav {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
        padding: 20px;
        background: var(--card-bg);
        margin: 20px auto;
        max-width: 1200px;
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        transition: background 0.3s;
    }
    
    .nav-btn {
        background: var(--card-bg);
        border: 2px solid var(--light-gray);
        color: var(--primary);
        padding: 12px 20px;
        border-radius: 50px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .nav-btn:hover {
        background: var(--light-gray);
        transform: translateY(-2px);
    }
    
    .nav-btn.active {
        background: linear-gradient(to right, var(--primary), var(--accent));
        color: rgb(255, 255, 255);
        border-color: transparent;
        box-shadow: 0 4px 10px rgba(74, 111, 165, 0.3);
    }
    
    /* CONTAINER */
    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }
    
    /* –ö–ê–†–¢–ö–ò */
    .cards-container {
        display: grid;
        gap: 20px;
    }

    .card {
        background: var(--card-bg);
        padding: 25px;
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        border-left: 5px solid var(--accent);
        display: none;
        animation: fadeIn 0.5s ease;
        transition: background 0.3s;
    }

    .card.active {
        display: block;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .card h2 {
        color: var(--primary);
        margin-bottom: 15px;
        font-size: 1.5rem;
    }

    .info-box {
        background: var(--light);
        padding: 15px;
        border-radius: 8px;
        margin-top: 15px;
        transition: background 0.3s;
    }

    /* –ü–û–°–ò–õ–ê–ù–ù–Ø */
    .drive-link {
        display: inline-block;
        background: linear-gradient(to right, var(--primary), var(--primary-dark));
        color: rgb(255, 255, 255);
        padding: 12px 20px;
        border-radius: 50px;
        text-decoration: none;
        font-weight: 600;
        margin-top: 10px;
        transition: all 0.3s;
        border: 2px solid transparent;
    }

    .drive-link:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(74, 111, 165, 0.3);
    }

    .groups-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 10px;
        margin-top: 15px;
    }

    .group-link {
        background: var(--card-bg);
        border: 2px solid var(--light-gray);
        padding: 12px;
        border-radius: 8px;
        text-decoration: none;
        color: var(--primary);
        font-weight: 600;
        text-align: center;
        transition: all 0.3s;
    }

    .group-link:hover {
        background: var(--light-gray);
        transform: translateY(-2px);
    }
    
    /* –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 1000;
        justify-content: center;
        align-items: center;
        backdrop-filter: blur(5px);
    }

    .modal-content {
        background: var(--card-bg);
        padding: 30px;
        border-radius: var(--radius);
        width: 90%;
        max-width: 400px;
        position: relative;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        animation: modalAppear 0.3s ease;
        transition: background 0.3s;
    }

    @keyframes modalAppear {
        from {
            opacity: 0;
            transform: translateY(-20px) scale(0.95);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    .modal-close {
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: var(--text-color);
        transition: color 0.3s;
    }

    .modal-close:hover {
        color: var(--primary);
    }

    .modal h3 {
        color: var(--primary);
        margin-bottom: 20px;
        text-align: center;
    }

    .modal-tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        border-bottom: 2px solid var(--light-gray);
        padding-bottom: 10px;
    }

    .modal-tab {
        background: none;
        border: none;
        padding: 10px 20px;
        font-weight: 600;
        color: var(--text-color);
        cursor: pointer;
        border-radius: 5px;
        transition: all 0.3s;
        flex: 1;
        text-align: center;
    }

    .modal-tab.active {
        background: var(--primary);
        color: white;
    }

    .modal-input {
        width: 100%;
        padding: 12px;
        margin: 10px 0;
        border: 2px solid var(--light-gray);
        border-radius: 8px;
        font-size: 1rem;
        background: var(--light);
        color: var(--text-color);
        transition: all 0.3s;
    }

    .modal-input:focus {
        outline: none;
        border-color: var(--accent);
    }

    .modal-btn {
        width: 100%;
        padding: 12px;
        background: linear-gradient(to right, var(--primary), var(--primary-dark));
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        margin-top: 10px;
        transition: all 0.3s;
    }

    .modal-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(74, 111, 165, 0.3);
    }

    .demo-info {
        margin-top: 15px;
        padding: 15px;
        background: var(--light);
        border-radius: 8px;
        font-size: 0.9rem;
        color: var(--text-color);
        opacity: 0.8;
        transition: background 0.3s;
    }

    /* –í—ñ–∫–Ω–æ –ø—Ä–æ—Ñ—ñ–ª—é */
    .profile-dropdown {
        display: none;
        position: absolute;
        top: 100%;
        right: 20px;
        background: var(--card-bg);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        min-width: 250px;
        z-index: 100;
        margin-top: 10px;
        animation: dropdownAppear 0.3s ease;
        border: 1px solid var(--light-gray);
    }

    @keyframes dropdownAppear {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .profile-header {
        padding: 20px;
        display: flex;
        align-items: center;
        gap: 15px;
        border-bottom: 1px solid var(--light-gray);
    }

    .profile-avatar-large {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid var(--primary);
    }

    .profile-info {
        flex: 1;
    }

    .profile-name {
        font-weight: 600;
        font-size: 1.1rem;
        color: var(--text-color);
    }

    .profile-email {
        font-size: 0.9rem;
        opacity: 0.8;
        color: var(--text-color);
    }

    .profile-menu {
        padding: 10px 0;
    }

    .profile-menu-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 12px 20px;
        color: var(--text-color);
        text-decoration: none;
        cursor: pointer;
        transition: all 0.3s;
        border: none;
        background: none;
        width: 100%;
        text-align: left;
        font-size: 1rem;
    }

    .profile-menu-item:hover {
        background: var(--light-gray);
    }

    .theme-switch {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 20px;
        color: var(--text-color);
    }

    .theme-toggle {
        position: relative;
        width: 50px;
        height: 26px;
        background: var(--light-gray);
        border-radius: 13px;
        cursor: pointer;
    }

    .theme-toggle::after {
        content: '';
        position: absolute;
        top: 3px;
        left: 3px;
        width: 20px;
        height: 20px;
        background: var(--primary);
        border-radius: 50%;
        transition: transform 0.3s;
    }

    .dark-theme .theme-toggle::after {
        transform: translateX(24px);
    }

    .avatar-upload {
        position: relative;
        display: inline-block;
        cursor: pointer;
    }

    .avatar-upload input[type="file"] {
        display: none;
    }

    .avatar-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: opacity 0.3s;
        color: white;
        font-size: 12px;
        text-align: center;
        padding: 5px;
    }

    .avatar-upload:hover .avatar-overlay {
        opacity: 1;
    }

    /* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è */
    .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(255,255,255,.3);
        border-radius: 50%;
        border-top-color: #fff;
        animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
        to { transform: rotate(360deg); }
    }

    /* FOOTER */
    footer {
        text-align: center;
        padding: 30px 20px;
        background: var(--dark);
        color: white;
        margin-top: 40px;
        transition: background 0.3s;
    }

    .footer-sub {
        opacity: 0.8;
        font-size: 0.9rem;
        margin-top: 5px;
    }

    /* RESPONSIVE */
    @media (max-width: 768px) {
        nav {
            flex-direction: column;
            align-items: center;
        }
        
        .nav-btn {
            width: 100%;
            max-width: 300px;
            justify-content: center;
        }
        
        .groups-grid {
            grid-template-columns: 1fr 1fr;
        }
        
        .container {
            padding: 15px;
        }
        
        .card {
            padding: 20px;
        }
        
        .header-buttons {
            flex-direction: column;
            align-items: center;
        }
        
        .user-profile-header {
            width: 100%;
            justify-content: center;
        }
        
        .profile-dropdown {
            right: 10px;
            left: 10px;
            min-width: auto;
        }
    }

    @media (max-width: 480px) {
        .groups-grid {
            grid-template-columns: 1fr;
        }
        
        header h1 {
            font-size: 1.8rem;
        }
        
        .header-btn {
            padding: 10px 20px;
            font-size: 0.9rem;
        }
    }
    </style>
</head>
<body>

<header>
    <h1>–û–≤—Ä—É—Ü—å–∫–∏–π –ó–î–û ‚Ññ8 ¬´–õ–∞—Å—Ç—ñ–≤–∫–∞¬ª –û–≤—Ä—É—Ü—å–∫–æ—ó –º—ñ—Å—å–∫–æ—ó —Ä–∞–¥–∏</h1>
    <p>–û—Ñ—ñ—Ü—ñ–π–Ω–∏–π —Å–∞–π—Ç –¥–∏—Ç—è—á–æ–≥–æ —Å–∞–¥–∫–∞</p>
    <div class="header-buttons">
        <button class="header-btn" id="loginBtn" onclick="openAuthModal()">
            <span>üîê</span> –£–≤—ñ–π—Ç–∏ / –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è
        </button>
        <div class="user-profile-header" id="userProfileBtn" style="display: none;" onclick="toggleProfileDropdown()">
            <img src="" alt="–ê–≤–∞—Ç–∞—Ä" class="user-avatar" id="headerAvatar">
            <span class="user-name" id="headerUserName"></span>
        </div>
    </div>
</header>

<!-- –í–∏–ø–∞–¥–∞—é—á–µ –º–µ–Ω—é –ø—Ä–æ—Ñ—ñ–ª—é -->
<div class="profile-dropdown" id="profileDropdown">
    <div class="profile-header">
        <div class="avatar-upload">
            <img src="" alt="–ê–≤–∞—Ç–∞—Ä" class="profile-avatar-large" id="profileAvatar">
            <div class="avatar-overlay">
                –ó–º—ñ–Ω–∏—Ç–∏<br>–∞–≤–∞—Ç–∞—Ä
                <input type="file" id="avatarInput" accept="image/*" onchange="uploadAvatar(event)">
            </div>
        </div>
        <div class="profile-info">
            <div class="profile-name" id="profileUserName"></div>
            <div class="profile-email" id="profileUserEmail"></div>
        </div>
    </div>
    <div class="profile-menu">
        <button class="profile-menu-item" onclick="openEditProfileModal()">
            <span>‚úèÔ∏è</span> –ó–º—ñ–Ω–∏—Ç–∏ —ñ–º'—è
        </button>
        <button class="profile-menu-item" onclick="openAvatarModal()">
            <span>üñºÔ∏è</span> –ó–º—ñ–Ω–∏—Ç–∏ –∞–≤–∞—Ç–∞—Ä
        </button>
        <div class="theme-switch">
            <span>üåì</span> –¢–µ–º–Ω–∞ —Ç–µ–º–∞
            <div class="theme-toggle" onclick="toggleTheme()"></div>
        </div>
        <button class="profile-menu-item" onclick="logout()">
            <span>üö™</span> –í–∏–π—Ç–∏
        </button>
    </div>
</div>

<nav>
    <button class="nav-btn active" onclick="showTab('home')">üè† –ì–æ–ª–æ–≤–Ω–∞</button>
    <button class="nav-btn" onclick="showTab('news')">üì∞ –ù–æ–≤–∏–Ω–∏</button>
    <button class="nav-btn" onclick="showTab('album')">üì∏ –§–æ—Ç–æ</button>
    <button class="nav-btn" onclick="showTab('groups')">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –ì—Ä—É–ø–∏</button>
    <button class="nav-btn" onclick="showTab('schedule')">üìÖ –†–æ–∑–∫–ª–∞–¥</button>
    <button class="nav-btn" onclick="showTab('collective')">üë©‚Äçüè´ –ü–µ–¥–∫–æ–ª–µ–∫—Ç–∏–≤</button>
    <button class="nav-btn" onclick="showTab('inclusive')">‚ù§Ô∏è –Ü–Ω–∫–ª—é–∑—ñ—è</button>
    <button class="nav-btn" onclick="showTab('statut')">üìã –°—Ç–∞—Ç—É—Ç</button>
    <button class="nav-btn" onclick="showTab('orders')">üìÑ –ù–∞–∫–∞–∑–∏</button>
</nav>

<div class="container">
    <div class="cards-container">
        <!-- –ì–û–õ–û–í–ù–ê -->
        <div id="home" class="card active">
            <h2>üè† –õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ!</h2>
            <p>–û—Ñ—ñ—Ü—ñ–π–Ω–∏–π —Å–∞–π—Ç –û–≤—Ä—É—Ü—å–∫–∏–π –ó–î–û ‚Ññ8 ¬´–õ–∞—Å—Ç—ñ–≤–∫–∞¬ª –û–≤—Ä—É—Ü—å–∫–æ—ó –º—ñ—Å—å–∫–æ—ó —Ä–∞–¥–∏‚Äî –º—ñ—Å—Ü–µ, –¥–µ –∫–æ–∂–Ω–∞ –¥–∏—Ç–∏–Ω–∞ –æ—Ç—Ä–∏–º—É—î —Ç—É—Ä–±–æ—Ç—É, –ª—é–±–æ–≤ —Ç–∞ —è–∫—ñ—Å–Ω—É –¥–æ—à–∫—ñ–ª—å–Ω—É –æ—Å–≤—ñ—Ç—É.</p>
            <p><strong>–ù–∞—à–∞ –º—ñ—Å—ñ—è:</strong> —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ —Ç–∞ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –¥–ª—è –≥–∞—Ä–º–æ–Ω—ñ–π–Ω–æ–≥–æ —Ä–æ–∑–≤–∏—Ç–∫—É –¥—ñ—Ç–µ–π –≤—ñ–∫–æ–º –≤—ñ–¥ 1 –¥–æ 6 —Ä–æ–∫—ñ–≤.</p>
            <div class="info-box">
                <p><strong>üìç –ê–¥—Ä–µ—Å–∞:</strong> –≤—É–ª. –ü—Ä–∏–∫–æ—Ä–¥–æ–Ω–Ω–∞</p>
            </div>
        </div>

        <!-- –ù–û–í–ò–ù–ò -->
        <div id="news" class="card">
            <h2>üì∞ –ù–æ–≤–∏–Ω–∏ —Ç–∞ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è</h2>
            <p>–ê–∫—Ç—É–∞–ª—å–Ω—ñ –Ω–æ–≤–∏–Ω–∏ —Ç–∞ –≤–∞–∂–ª–∏–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –¥–ª—è –±–∞—Ç—å–∫—ñ–≤:</p>
            <a class="drive-link" href="https://drive.google.com/drive/folders/1zooffQ541chkyuKTUul2nkPjJDwirvxQ" target="_blank">
                üìÅ –ù–æ–≤–∏–Ω–∏ –Ω–∞—à–æ–≥–æ —Å–∞–¥–æ—á–∫–∞
            </a>
        </div>

        <!-- –§–û–¢–û–ê–õ–¨–ë–û–ú -->
        <div id="album" class="card">
            <h2>üì∏ –§–æ—Ç–æ–∞–ª—å–±–æ–º –Ω–∞—à–æ–≥–æ —Å–∞–¥–æ—á–∫–∞</h2>
            <p>–§–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—ó –∑ –∂–∏—Ç—Ç—è –Ω–∞—à–æ–≥–æ —Å–∞–¥–æ—á–∫–∞:</p>
            <a class="drive-link" href="https://drive.google.com/drive/folders/1IknDuijQtf-RrgZ8PtK89K1W2_tWz6xU" target="_blank">
                üìÅ –§–æ—Ç–æ–∞–ª—å–±–æ–º
            </a>
        </div>

        <!-- –ì–†–£–ü–ò -->
        <div id="groups" class="card">
            <h2>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –ì—Ä—É–ø–∏ —Å–∞–¥–æ—á–∫–∞</h2>
            <p>–û–±–µ—Ä—ñ—Ç—å –≥—Ä—É–ø—É –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤:</p>
            <div class="groups-grid">
                <a class="group-link" href="https://drive.google.com/drive/folders/1JGMSOMT_J2t3BaH-gb9zfTsBa0Mwcit_" target="_blank">üçØ –ë–¥–∂—ñ–ª–∫–∏</a>
                <a class="group-link" href="https://drive.google.com/drive/folders/1x4hdq03XGAvSasfasuUZDnglTzIGeAtl" target="_blank">üåà –í–µ—Å–µ–ª–∫–∞</a>
                <a class="group-link" href="https://drive.google.com/drive/folders/1NniCYxUD-PQG7C_QRuWc7xw02BMgdagk" target="_blank">‚≠ê –ó—ñ—Ä–æ—á–∫–∏</a>
                <a class="group-link" href="https://drive.google.com/drive/folders/1ILclmWrIcnjUO5A0inVl1lFKYr-M0KZ2" target="_blank">üíß –ö—Ä–∞–ø–ª–∏–Ω–∫–∏</a>
                <a class="group-link" href="https://drive.google.com/drive/folders/1_88DhBgMjTTY9Bnxh-HFlhyIHROHkx5B" target="_blank">üîç –ü—ñ–∑–Ω–∞–π–∫–æ</a>
                <a class="group-link" href="https://drive.google.com/drive/folders/1IaHJfVHh_g9W55Yc1ZIeGVPBQqsZxdAG" target="_blank">‚òÄÔ∏è –°–æ–Ω–µ—á–∫–æ</a>
                <a class="group-link" href="https://drive.google.com/drive/folders/1cjb4QtNFRAcVbNB62YaHsp0n8L4r8wzg" target="_blank">üåª –°–æ–Ω—è—à–Ω–∏–∫</a>
                <a class="group-link" href="https://drive.google.com/drive/folders/16wVHEkqukh9DEyDiaW_QqjnBCH_aWxDn" target="_blank">‚ùì –ß–æ–º—É—Å–∏–∫–∏</a>
            </div>
        </div>

        <!-- –†–û–ó–ö–õ–ê–î -->
        <div id="schedule" class="card">
            <h2>üìÖ –†–æ–∑–∫–ª–∞–¥ –∑–∞–Ω—è—Ç—å</h2>
            <p>–©–æ–¥–µ–Ω–Ω–∏–π —Ä–æ–∑–∫–ª–∞–¥ —Ç–∞ —Ä–µ–∂–∏–º –¥–Ω—è –Ω–∞—à–æ–≥–æ —Å–∞–¥–æ—á–∫–∞:</p>
            <a class="drive-link" href="https://drive.google.com/drive/folders/1WiA4RmGSrRH29CbrXg14df5JtuYd6TeJ" target="_blank">
                üìÅ –†–æ–∑–∫–ª–∞–¥
            </a>
        </div>

        <!-- –ü–ï–î–ö–û–õ–ï–ö–¢–ò–í -->
        <div id="collective" class="card">
            <h2>üë©‚Äçüè´ –ü–µ–¥–∞–≥–æ–≥—ñ—á–Ω–∏–π –∫–æ–ª–µ–∫—Ç–∏–≤</h2>
            <p>–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –Ω–∞—à–∏—Ö –ø–µ–¥–∞–≥–æ–≥—ñ–≤:</p>
            <a class="drive-link" href="https://drive.google.com/drive/folders/1Fwu64LsLkIeybCPFTni-_5DgFPvtBMp7" target="_blank">
                üìÅ –î–æ–∫—É–º–µ–Ω—Ç–∏ –ø–µ–¥–∫–æ–ª–µ–∫—Ç–∏–≤—É
            </a>
        </div>

        <!-- –Ü–ù–ö–õ–Æ–ó–Ü–Ø -->
        <div id="inclusive" class="card">
            <h2>‚ù§Ô∏è –Ü–Ω–∫–ª—é–∑–∏–≤–Ω–∞ –æ—Å–≤—ñ—Ç–∞</h2>
            <p>–î–æ–∫—É–º–µ–Ω—Ç–∏ –∑ —ñ–Ω–∫–ª—é–∑–∏–≤–Ω–æ—ó –æ—Å–≤—ñ—Ç–∞ –Ω–∞—à–æ–≥–æ —Å–∞–¥–æ—á–∫–∞:</p>
            <a class="drive-link" href="https://drive.google.com/drive/folders/10Q-sd76LpOaqeMxjuyNNYUhFwHMz3lRK" target="_blank">
                üìÅ –î–æ–∫—É–º–µ–Ω—Ç–∏ –∑ —ñ–Ω–∫–ª—é–∑—ñ—ó
            </a>
        </div>

        <!-- –°–¢–ê–¢–£–¢ -->
        <div id="statut" class="card">
            <h2>üìã –°—Ç–∞—Ç—É—Ç</h2>
            <p>–û—Ñ—ñ—Ü—ñ–π–Ω–∏–π —Å—Ç–∞—Ç—É—Ç —Å–∞–¥–æ—á–∫–∞:</p>
            <a class="drive-link" href="https://drive.google.com/drive/folders/1fJZhnr-yTZ5Uecl4jdnkuSEDhleSx0dz" target="_blank">
                üìÅ –°—Ç–∞—Ç—É—Ç
            </a>
        </div>

        <!-- –ù–ê–ö–ê–ó–ò -->
        <div id="orders" class="card">
            <h2>üìÑ –ù–∞–∫–∞–∑–∏</h2>
            <p>–ù–∞–∫–∞–∑–∏:</p>
            <a class="drive-link" href="https://drive.google.com/drive/folders/1ANR6bzU3viTLAgj2NSY-n6JfDlzs_9mS" target="_blank">
                üìÅ –ù–∞–∫–∞–∑–∏ –Ω–∞—à–æ–≥–æ —Å–∞–¥–æ—á–∫–∞
            </a>
        </div>
    </div>
</div>

<!-- –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û –ê–í–¢–û–†–ò–ó–ê–¶–Ü–á -->
<div id="authModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeAuthModal()">√ó</button>
        <h3>üîê –£–≤—ñ–π—Ç–∏ / –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</h3>
        <div class="modal-tabs">
            <button class="modal-tab active" onclick="switchAuthTab('login')">–í—Ö—ñ–¥</button>
            <button class="modal-tab" onclick="switchAuthTab('register')">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</button>
        </div>
        <div id="loginForm">
            <input type="email" class="modal-input" id="loginEmail" placeholder="Email">
            <input type="password" class="modal-input" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å">
            <button class="modal-btn" id="loginButton" onclick="handleLogin()">
                <span id="loginText">–£–≤—ñ–π—Ç–∏</span>
                <span id="loginLoading" class="loading" style="display: none;"></span>
            </button>
        </div>
        <div id="registerForm" style="display: none;">
            <input type="text" class="modal-input" id="registerName" placeholder="–í–∞—à–µ —ñ–º'—è">
            <input type="email" class="modal-input" id="registerEmail" placeholder="Email">
            <input type="password" class="modal-input" id="registerPassword" placeholder="–ü–∞—Ä–æ–ª—å">
            <input type="password" class="modal-input" id="registerConfirmPassword" placeholder="–ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å">
            <button class="modal-btn" id="registerButton" onclick="handleRegister()">
                <span id="registerText">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</span>
                <span id="registerLoading" class="loading" style="display: none;"></span>
            </button>
        </div>
        <div class="demo-info">
            <p><strong></strong></p>
            <p></p>
            <p></p>
        </div>
    </div>
</div>

<!-- –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û –†–ï–î–ê–ì–£–í–ê–ù–ù–Ø –ü–†–û–§–Ü–õ–Æ -->
<div id="editProfileModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeEditProfileModal()">√ó</button>
        <h3>‚úèÔ∏è –ó–º—ñ–Ω–∏—Ç–∏ —ñ–º'—è</h3>
        <input type="text" class="modal-input" id="editProfileName" placeholder="–ù–æ–≤–µ —ñ–º'—è">
        <button class="modal-btn" id="saveProfileButton" onclick="saveProfileName()">
            <span id="saveProfileText">–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</span>
            <span id="saveProfileLoading" class="loading" style="display: none;"></span>
        </button>
    </div>
</div>

<!-- –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û –ó–ú–Ü–ù–ò –ê–í–ê–¢–ê–†–ê -->
<div id="avatarModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeAvatarModal()">√ó</button>
        <h3>üñºÔ∏è –ó–º—ñ–Ω–∏—Ç–∏ –∞–≤–∞—Ç–∞—Ä</h3>
        <div style="text-align: center; margin: 20px 0;">
            <div class="avatar-upload" style="display: inline-block;">
                <img src="" alt="–ê–≤–∞—Ç–∞—Ä" class="profile-avatar-large" id="modalAvatarPreview" style="width: 120px; height: 120px;">
                <div class="avatar-overlay" style="width: 120px; height: 120px;">
                    –í–∏–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª
                </div>
                <input type="file" id="modalAvatarInput" accept="image/*" onchange="previewAvatar(event)">
            </div>
        </div>
        <button class="modal-btn" id="saveAvatarButton" onclick="saveAvatar()">
            <span id="saveAvatarText">–ó–±–µ—Ä–µ–≥—Ç–∏ –∞–≤–∞—Ç–∞—Ä</span>
            <span id="saveAvatarLoading" class="loading" style="display: none;"></span>
        </button>
    </div>
</div>

<footer>
    <p>¬© 2026 –û–≤—Ä—É—Ü—å–∫–∏–π –ó–î–û ‚Ññ8 –õ–∞—Å—Ç—ñ–≤–∫–∞ –û–≤—Ä—É—Ü—å–∫–æ—ó –º—ñ—Å—å–∫–æ—ó —Ä–∞–¥–∏.</p>
    <p class="footer-sub">–û—Ñ—ñ—Ü—ñ–π–Ω–∏–π —Å–∞–π—Ç —Å–∞–¥–æ—á–∫—É</p>
</footer>

<script>
// ========== FIREBASE CONFIGURATION ==========
const firebaseConfig = {
    apiKey: "AIzaSyD0tJbZoYdKOCHQNXYwd3_ATevH0tAjC-8",
    authDomain: "zdo-lastivka.firebaseapp.com",
    projectId: "zdo-lastivka",
    storageBucket: "zdo-lastivka.firebasestorage.app",
    messagingSenderId: "920607978182",
    appId: "1:920607978182:web:1e035a72ed1c146f7a1dc7"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
const storage = firebase.storage();

// ========== –ì–õ–û–ë–ê–õ–¨–ù–Ü –ó–ú–Ü–ù–ù–Ü ==========
let currentUser = null;
let isDarkTheme = false;
let avatarFile = null;

// ========== –§–£–ù–ö–¶–Ü–á –î–õ–Ø COOKIES (—Ç—ñ–ª—å–∫–∏ –¥–ª—è —Ç–µ–º–∏) ==========
function setCookie(name, value, days) {
    let expires = "";
    if (days) {
        const date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + (value || "") + expires + "; path=/";
}

function getCookie(name) {
    const nameEQ = name + "=";
    const ca = document.cookie.split(';');
    for(let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) === ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
}

function eraseCookie(name) {   
    document.cookie = name + '=; Max-Age=-99999999; path=/';
}

// ========== –§–£–ù–ö–¶–Ü–á –î–õ–Ø –¢–ï–ú–ò ==========
function saveThemePreference(isDark) {
    setCookie('lastivka_theme', isDark ? 'dark' : 'light', 365);
}

function getThemePreference() {
    const theme = getCookie('lastivka_theme');
    return theme === 'dark';
}

function applyTheme(isDark) {
    if (isDark) {
        document.body.classList.add('dark-theme');
    } else {
        document.body.classList.remove('dark-theme');
    }
    window.isDarkTheme = isDark;
    saveThemePreference(isDark);
}

function toggleTheme() {
    const newTheme = !window.isDarkTheme;
    applyTheme(newTheme);
}

// ========== –û–°–ù–û–í–ù–Ü –§–£–ù–ö–¶–Ü–á ==========
function showTab(tabId) {
    document.querySelectorAll('.card').forEach(card => {
        card.classList.remove('active');
    });
    
    document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    const selectedCard = document.getElementById(tabId);
    if (selectedCard) {
        selectedCard.classList.add('active');
    }
    
    const activeButton = document.querySelector(`[onclick="showTab('${tabId}')"]`);
    if (activeButton) {
        activeButton.classList.add('active');
    }
    
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

// ========== –§–£–ù–ö–¶–Ü–á –î–õ–Ø –ú–û–î–ê–õ–¨–ù–ò–• –í–Ü–ö–û–ù ==========
function openAuthModal() {
    document.getElementById('authModal').style.display = 'flex';
    document.getElementById('loginEmail').focus();
    switchAuthTab('login');
}

function closeAuthModal() {
    document.getElementById('authModal').style.display = 'none';
    document.getElementById('loginEmail').value = '';
    document.getElementById('loginPassword').value = '';
    document.getElementById('registerName').value = '';
    document.getElementById('registerEmail').value = '';
    document.getElementById('registerPassword').value = '';
    document.getElementById('registerConfirmPassword').value = '';
}

function switchAuthTab(tab) {
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    const loginTab = document.querySelector('[onclick="switchAuthTab(\'login\')"]');
    const registerTab = document.querySelector('[onclick="switchAuthTab(\'register\')"]');
    
    if (tab === 'login') {
        loginForm.style.display = 'block';
        registerForm.style.display = 'none';
        loginTab.classList.add('active');
        registerTab.classList.remove('active');
    } else {
        loginForm.style.display = 'none';
        registerForm.style.display = 'block';
        loginTab.classList.remove('active');
        registerTab.classList.add('active');
    }
}

function openEditProfileModal() {
    if (!window.currentUser) return;
    
    document.getElementById('editProfileModal').style.display = 'flex';
    document.getElementById('editProfileName').value = window.currentUser.displayName || '';
    document.getElementById('editProfileName').focus();
    closeProfileDropdown();
}

function closeEditProfileModal() {
    document.getElementById('editProfileModal').style.display = 'none';
}

function openAvatarModal() {
    if (!window.currentUser) return;
    
    const avatarImg = document.getElementById('modalAvatarPreview');
    avatarImg.src = window.currentUser.photoURL || getDefaultAvatar();
    
    document.getElementById('avatarModal').style.display = 'flex';
    closeProfileDropdown();
}

function closeAvatarModal() {
    document.getElementById('avatarModal').style.display = 'none';
    document.getElementById('modalAvatarInput').value = '';
    window.avatarFile = null;
}

// ========== FIREBASE –ê–í–¢–û–†–ò–ó–ê–¶–Ü–Ø ==========
async function handleLogin() {
    const email = document.getElementById('loginEmail').value.trim();
    const password = document.getElementById('loginPassword').value.trim();
    
    if (!email || !password) {
        alert('‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è');
        return;
    }
    
    // –ü–æ–∫–∞–∑—É—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
    const loginBtn = document.getElementById('loginButton');
    const loginText = document.getElementById('loginText');
    const loginLoading = document.getElementById('loginLoading');
    
    loginText.style.display = 'none';
    loginLoading.style.display = 'inline-block';
    loginBtn.disabled = true;
    
    try {
        const userCredential = await auth.signInWithEmailAndPassword(email, password);
        const user = userCredential.user;
        
        // –û—Ç—Ä–∏–º—É—î–º–æ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ Firestore
        const userDoc = await db.collection('users').doc(user.uid).get();
        
        if (userDoc.exists) {
            const userData = userDoc.data();
            window.currentUser = {
                uid: user.uid,
                email: user.email,
                displayName: user.displayName || userData.displayName || '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á',
                photoURL: user.photoURL || userData.photoURL || null,
                role: userData.role || 'user',
                createdAt: userData.createdAt || user.metadata.creationTime
            };
        } else {
            window.currentUser = {
                uid: user.uid,
                email: user.email,
                displayName: user.displayName || '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á',
                photoURL: user.photoURL || null,
                role: 'user',
                createdAt: user.metadata.creationTime
            };
        }
        
        updateUIAfterLogin();
        closeAuthModal();
        
        alert(`‚úÖ –í—ñ—Ç–∞—î–º–æ, ${window.currentUser.displayName}! –£—Å–ø—ñ—à–Ω–∏–π –≤—Ö—ñ–¥ –≤ —Å–∏—Å—Ç–µ–º—É.`);
        
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É:', error);
        
        let errorMessage = '‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É. ';
        switch (error.code) {
            case 'auth/user-not-found':
                errorMessage += '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.';
                break;
            case 'auth/wrong-password':
                errorMessage += '–ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å.';
                break;
            case 'auth/invalid-email':
                errorMessage += '–ù–µ–≤—ñ—Ä–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç email.';
                break;
            case 'auth/user-disabled':
                errorMessage += '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤–∏–º–∫–Ω–µ–Ω–æ.';
                break;
            default:
                errorMessage += '–°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.';
        }
        
        alert(errorMessage);
    } finally {
        // –•–æ–≤–∞—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        loginText.style.display = 'inline';
        loginLoading.style.display = 'none';
        loginBtn.disabled = false;
    }
}

async function handleRegister() {
    const name = document.getElementById('registerName').value.trim();
    const email = document.getElementById('registerEmail').value.trim();
    const password = document.getElementById('registerPassword').value.trim();
    const confirmPassword = document.getElementById('registerConfirmPassword').value.trim();
    
    if (!name || !email || !password || !confirmPassword) {
        alert('‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è');
        return;
    }
    
    if (password !== confirmPassword) {
        alert('‚ùå –ü–∞—Ä–æ–ª—ñ –Ω–µ —Å–ø—ñ–≤–ø–∞–¥–∞—é—Ç—å');
        return;
    }
    
    if (password.length < 6) {
        alert('‚ùå –ü–∞—Ä–æ–ª—å –º–∞—î –º—ñ—Å—Ç–∏—Ç–∏ —â–æ–Ω–∞–π–º–µ–Ω—à–µ 6 —Å–∏–º–≤–æ–ª—ñ–≤');
        return;
    }
    
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ email
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
        alert('‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–∏–π email');
        return;
    }
    
    // –ü–æ–∫–∞–∑—É—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
    const registerBtn = document.getElementById('registerButton');
    const registerText = document.getElementById('registerText');
    const registerLoading = document.getElementById('registerLoading');
    
    registerText.style.display = 'none';
    registerLoading.style.display = 'inline-block';
    registerBtn.disabled = true;
    
    try {
        // –°—Ç–≤–æ—Ä—é—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ Firebase Authentication
        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
        const user = userCredential.user;
        
        // –û–Ω–æ–≤–ª—é—î–º–æ –≤—ñ–¥–æ–±—Ä–∞–∂—É–≤–∞–Ω–µ —ñ–º'—è
        await user.updateProfile({
            displayName: name
        });
        
        // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ –≤ Firestore
        await db.collection('users').doc(user.uid).set({
            uid: user.uid,
            email: email,
            displayName: name,
            photoURL: null,
            role: 'user',
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        window.currentUser = {
            uid: user.uid,
            email: user.email,
            displayName: name,
            photoURL: null,
            role: 'user',
            createdAt: new Date().toISOString()
        };
        
        updateUIAfterLogin();
        closeAuthModal();
        
        alert(`‚úÖ –í—ñ—Ç–∞—î–º–æ, ${name}! –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –ø—Ä–æ–π—à–ª–∞ —É—Å–ø—ñ—à–Ω–æ.`);
        
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó:', error);
        
        let errorMessage = '‚ùå –ü–æ–º–∏–ª–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó. ';
        switch (error.code) {
            case 'auth/email-already-in-use':
                errorMessage += '–¶–µ–π email –≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è.';
                break;
            case 'auth/invalid-email':
                errorMessage += '–ù–µ–≤—ñ—Ä–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç email.';
                break;
            case 'auth/operation-not-allowed':
                errorMessage += '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –≤–∏–º–∫–Ω–µ–Ω–∞.';
                break;
            case 'auth/weak-password':
                errorMessage += '–ü–∞—Ä–æ–ª—å –∑–∞–Ω–∞–¥—Ç–æ —Å–ª–∞–±–∫–∏–π.';
                break;
            default:
                errorMessage += '–°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.';
        }
        
        alert(errorMessage);
    } finally {
        // –•–æ–≤–∞—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        registerText.style.display = 'inline';
        registerLoading.style.display = 'none';
        registerBtn.disabled = false;
    }
}

// ========== –§–£–ù–ö–¶–Ü–á –ü–†–û–§–Ü–õ–Æ ==========
function updateUIAfterLogin() {
    if (!window.currentUser) return;
    
    document.getElementById('loginBtn').style.display = 'none';
    document.getElementById('userProfileBtn').style.display = 'flex';
    
    updateProfileUI();
}

function updateProfileUI() {
    if (!window.currentUser) return;
    
    const user = window.currentUser;
    const defaultAvatar = getDefaultAvatar();
    
    // –û–Ω–æ–≤–ª—é—î–º–æ —Ö–µ–¥–µ—Ä
    document.getElementById('headerAvatar').src = user.photoURL || defaultAvatar;
    document.getElementById('headerUserName').textContent = user.displayName;
    
    // –û–Ω–æ–≤–ª—é—î–º–æ –≤–∏–ø–∞–¥–∞—é—á–µ –º–µ–Ω—é
    document.getElementById('profileAvatar').src = user.photoURL || defaultAvatar;
    document.getElementById('profileUserName').textContent = user.displayName;
    document.getElementById('profileUserEmail').textContent = user.email;
}

function getDefaultAvatar() {
    const colors = ['#4a6fa5', '#6dbfb8', '#ff9a76', '#ffd166', '#06d6a0'];
    const color = colors[Math.floor(Math.random() * colors.length)];
    
    const canvas = document.createElement('canvas');
    canvas.width = 100;
    canvas.height = 100;
    const ctx = canvas.getContext('2d');
    
    // –§–æ–Ω
    ctx.fillStyle = color;
    ctx.fillRect(0, 0, 100, 100);
    
    // –¢–µ–∫—Å—Ç –∑ —ñ–Ω—ñ—Ü—ñ–∞–ª–∞–º–∏
    if (window.currentUser && window.currentUser.displayName) {
        const initials = window.currentUser.displayName.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
        ctx.fillStyle = 'white';
        ctx.font = 'bold 40px Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(initials, 50, 50);
    }
    
    return canvas.toDataURL();
}

function toggleProfileDropdown() {
    const dropdown = document.getElementById('profileDropdown');
    if (dropdown.style.display === 'block') {
        dropdown.style.display = 'none';
    } else {
        dropdown.style.display = 'block';
        updateProfileUI();
    }
}

function closeProfileDropdown() {
    document.getElementById('profileDropdown').style.display = 'none';
}

async function saveProfileName() {
    const newName = document.getElementById('editProfileName').value.trim();
    
    if (!newName) {
        alert('‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —ñ–º\'—è');
        return;
    }
    
    // –ü–æ–∫–∞–∑—É—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
    const saveBtn = document.getElementById('saveProfileButton');
    const saveText = document.getElementById('saveProfileText');
    const saveLoading = document.getElementById('saveProfileLoading');
    
    saveText.style.display = 'none';
    saveLoading.style.display = 'inline-block';
    saveBtn.disabled = true;
    
    try {
        // –û–Ω–æ–≤–ª—é—î–º–æ –≤ Firebase Authentication
        const user = auth.currentUser;
        if (user) {
            await user.updateProfile({
                displayName: newName
            });
        }
        
        // –û–Ω–æ–≤–ª—é—î–º–æ –≤ Firestore
        await db.collection('users').doc(window.currentUser.uid).update({
            displayName: newName,
            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        // –û–Ω–æ–≤–ª—é—î–º–æ –ª–æ–∫–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ
        window.currentUser.displayName = newName;
        
        // –û–Ω–æ–≤–ª—é—î–º–æ UI
        updateProfileUI();
        closeEditProfileModal();
        
        alert('‚úÖ –Ü–º\'—è —É—Å–ø—ñ—à–Ω–æ –∑–º—ñ–Ω–µ–Ω–æ!');
        
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–º—ñ–Ω–∏ —ñ–º–µ–Ω—ñ:', error);
        alert('‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–º—ñ–Ω—ñ —ñ–º–µ–Ω—ñ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.');
    } finally {
        // –•–æ–≤–∞—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        saveText.style.display = 'inline';
        saveLoading.style.display = 'none';
        saveBtn.disabled = false;
    }
}

function previewAvatar(event) {
    const file = event.target.files[0];
    if (!file) return;
    
    if (!file.type.match('image.*')) {
        alert('‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–∏–±–µ—Ä—ñ—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è');
        return;
    }
    
    if (file.size > 5 * 1024 * 1024) { // 5MB
        alert('‚ùå –†–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É –Ω–µ –ø–æ–≤–∏–Ω–µ–Ω –ø–µ—Ä–µ–≤–∏—â—É–≤–∞—Ç–∏ 5MB');
        return;
    }
    
    window.avatarFile = file;
    
    const reader = new FileReader();
    reader.onload = function(e) {
        document.getElementById('modalAvatarPreview').src = e.target.result;
    };
    reader.readAsDataURL(file);
}

async function saveAvatar() {
    if (!window.avatarFile) {
        alert('‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–∏–±–µ—Ä—ñ—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è');
        return;
    }
    
    // –ü–æ–∫–∞–∑—É—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
    const saveBtn = document.getElementById('saveAvatarButton');
    const saveText = document.getElementById('saveAvatarText');
    const saveLoading = document.getElementById('saveAvatarLoading');
    
    saveText.style.display = 'none';
    saveLoading.style.display = 'inline-block';
    saveBtn.disabled = true;
    
    try {
        const user = auth.currentUser;
        if (!user) {
            throw new Error('–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π');
        }
        
        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –∞–≤–∞—Ç–∞—Ä –≤ Firebase Storage
        const storageRef = storage.ref();
        const avatarRef = storageRef.child(`avatars/${user.uid}/${Date.now()}_${window.avatarFile.name}`);
        const snapshot = await avatarRef.put(window.avatarFile);
        
        // –û—Ç—Ä–∏–º—É—î–º–æ URL –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        const downloadURL = await snapshot.ref.getDownloadURL();
        
        // –û–Ω–æ–≤–ª—é—î–º–æ –≤ Firebase Authentication
        await user.updateProfile({
            photoURL: downloadURL
        });
        
        // –û–Ω–æ–≤–ª—é—î–º–æ –≤ Firestore
        await db.collection('users').doc(user.uid).update({
            photoURL: downloadURL,
            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        // –û–Ω–æ–≤–ª—é—î–º–æ –ª–æ–∫–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ
        window.currentUser.photoURL = downloadURL;
        
        // –û–Ω–æ–≤–ª—é—î–º–æ UI
        updateProfileUI();
        closeAvatarModal();
        
        alert('‚úÖ –ê–≤–∞—Ç–∞—Ä —É—Å–ø—ñ—à–Ω–æ –∑–º—ñ–Ω–µ–Ω–æ!');
        
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–≤–∞—Ç–∞—Ä–∞:', error);
        alert('‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –∞–≤–∞—Ç–∞—Ä–∞. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.');
    } finally {
        // –•–æ–≤–∞—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        saveText.style.display = 'inline';
        saveLoading.style.display = 'none';
        saveBtn.disabled = false;
        window.avatarFile = null;
    }
}

function uploadAvatar(event) {
    const file = event.target.files[0];
    if (!file) return;
    
    if (!file.type.match('image.*')) {
        alert('‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–∏–±–µ—Ä—ñ—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è');
        return;
    }
    
    if (file.size > 5 * 1024 * 1024) { // 5MB
        alert('‚ùå –†–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É –Ω–µ –ø–æ–≤–∏–Ω–µ–Ω –ø–µ—Ä–µ–≤–∏—â—É–≤–∞—Ç–∏ 5MB');
        return;
    }
    
    // –ë–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—î –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
    saveAvatarFromFile(file);
}

async function saveAvatarFromFile(file) {
    try {
        const user = auth.currentUser;
        if (!user) {
            throw new Error('–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π');
        }
        
        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –∞–≤–∞—Ç–∞—Ä –≤ Firebase Storage
        const storageRef = storage.ref();
        const avatarRef = storageRef.child(`avatars/${user.uid}/${Date.now()}_${file.name}`);
        const snapshot = await avatarRef.put(file);
        
        // –û—Ç—Ä–∏–º—É—î–º–æ URL –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        const downloadURL = await snapshot.ref.getDownloadURL();
        
        // –û–Ω–æ–≤–ª—é—î–º–æ –≤ Firebase Authentication
        await user.updateProfile({
            photoURL: downloadURL
        });
        
        // –û–Ω–æ–≤–ª—é—î–º–æ –≤ Firestore
        await db.collection('users').doc(user.uid).update({
            photoURL: downloadURL,
            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        // –û–Ω–æ–≤–ª—é—î–º–æ –ª–æ–∫–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ
        window.currentUser.photoURL = downloadURL;
        
        // –û–Ω–æ–≤–ª—é—î–º–æ UI
        updateProfileUI();
        
        alert('‚úÖ –ê–≤–∞—Ç–∞—Ä —É—Å–ø—ñ—à–Ω–æ –∑–º—ñ–Ω–µ–Ω–æ!');
        
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–≤–∞—Ç–∞—Ä–∞:', error);
        alert('‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –∞–≤–∞—Ç–∞—Ä–∞. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.');
    }
}

async function logout() {
    try {
        await auth.signOut();
        window.currentUser = null;
        
        document.getElementById('loginBtn').style.display = 'inline-flex';
        document.getElementById('userProfileBtn').style.display = 'none';
        document.getElementById('profileDropdown').style.display = 'none';
        
        alert('‚úÖ –í–∏ —É—Å–ø—ñ—à–Ω–æ –≤–∏–π—à–ª–∏ –∑ —Å–∏—Å—Ç–µ–º–∏');
        
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –≤–∏—Ö–æ–¥—É:', error);
        alert('‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤–∏—Ö–æ–¥—ñ –∑ —Å–∏—Å—Ç–µ–º–∏');
    }
}

// ========== –Ü–ù–Ü–¶–Ü–ê–õ–Ü–ó–ê–¶–Ü–Ø ==========
document.addEventListener('DOMContentLoaded', async function() {
    // –ó–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ –∑–±–µ—Ä–µ–∂–µ–Ω—É —Ç–µ–º—É
    const savedTheme = getThemePreference();
    applyTheme(savedTheme);
    
    // –ü–æ–∫–∞–∑—É—î–º–æ –ø–µ—Ä—à—É –≤–∫–ª–∞–¥–∫—É
    showTab('home');
    
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∂–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π
    auth.onAuthStateChanged(async (user) => {
        if (user) {
            // –û—Ç—Ä–∏–º—É—î–º–æ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ Firestore
            const userDoc = await db.collection('users').doc(user.uid).get();
            
            if (userDoc.exists) {
                const userData = userDoc.data();
                window.currentUser = {
                    uid: user.uid,
                    email: user.email,
                    displayName: user.displayName || userData.displayName || '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á',
                    photoURL: user.photoURL || userData.photoURL || null,
                    role: userData.role || 'user',
                    createdAt: userData.createdAt || user.metadata.creationTime
                };
            } else {
                window.currentUser = {
                    uid: user.uid,
                    email: user.email,
                    displayName: user.displayName || '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á',
                    photoURL: user.photoURL || null,
                    role: 'user',
                    createdAt: user.metadata.creationTime
                };
            }
            
            updateUIAfterLogin();
        }
    });
    
    // –ó–∞–∫—Ä–∏–≤–∞—î–º–æ –º–æ–¥–∞–ª—å–Ω—ñ –≤—ñ–∫–Ω–∞ –ø–æ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –Ω–∏–º–∏
    document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', function(event) {
            if (event.target === this) {
                this.style.display = 'none';
            }
        });
    });
    
    // –ó–∞–∫—Ä–∏–≤–∞—î–º–æ –≤–∏–ø–∞–¥–∞—é—á–µ –º–µ–Ω—é –ø–æ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –Ω–∏–º
    document.addEventListener('click', function(event) {
        const dropdown = document.getElementById('profileDropdown');
        const profileBtn = document.getElementById('userProfileBtn');
        
        if (dropdown && dropdown.style.display === 'block' && 
            !dropdown.contains(event.target) && 
            (!profileBtn || !profileBtn.contains(event.target))) {
            dropdown.style.display = 'none';
        }
    });
    
    // –í—Ö—ñ–¥ –ø–æ Enter
    document.getElementById('loginPassword').addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            handleLogin();
        }
    });
    
    document.getElementById('registerConfirmPassword').addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            handleRegister();
        }
    });
    
    // –ó–∞–∫—Ä–∏—Ç–∏ –ø–æ Escape
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            closeAuthModal();
            closeEditProfileModal();
            closeAvatarModal();
            closeProfileDropdown();
        }
    });
    
    console.log('üöÄ –°–∞–π—Ç –ó–î–û ¬´–°–∞–¥–æ—á–æ–∫ –õ–∞—Å—Ç—ñ–≤–∫–∞¬ª –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!');
    console.log('üî• Firebase –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ!');
});
</script>
</body>
</html>
